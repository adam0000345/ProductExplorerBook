{"ast":null,"code":"import _classCallCheck from\"/Users/adam.tothfejel/Desktop/LabelBoxFolder/BirdHouse/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/adam.tothfejel/Desktop/LabelBoxFolder/BirdHouse/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import Utils from'./Utils';import SearchControls from'./SearchControls';var AppController=/*#__PURE__*/function(){function AppController(){_classCallCheck(this,AppController);}_createClass(AppController,null,[{key:\"loadMasterData\",value:function loadMasterData(){var _this=this;return fetch(\"./data/calls.json\").then(function(response){return response.json();}).then(function(json){var data={};for(var key in json){if(data[key]===undefined){data[key]=[];}for(var i in json[key]){var item=json[key][i];item.fields.id=item.id;data[key][i]=item.fields;if(!data.idIndex){data.idIndex={};}data.idIndex[item.id]=[key,parseInt(i)];}}//console.log(\"[LOG] data\", data);\n_this.setState({masterData:data});//this.setState({ masterData: data }, () => setTimeout(this.loadMasterData.bind(this), 60000))\n});}},{key:\"inputScratch\",value:function inputScratch(key,val){var state=this.state;if(Array.isArray(state.scratch[key])){state.scratch[key].push(val);state.scratch[key]=Utils.dedupe(state.scratch[key]);}else{state.scratch[key]=val;}this.setState(state);}},{key:\"setUIConfig\",value:function setUIConfig(key,val){var state=this.state;state.config.ui[key]=val;this.setState(state,function(){//console.log(\"NEW CONFIG\",this.state.config);\n});}},{key:\"getUIState\",value:function getUIState(key,val){var state=this.state;return state.state.ui[key];}},{key:\"setUIState\",value:function setUIState(key,val){var state=this.state;state.state.ui[key]=val;this.setState(state,function(){// console.log(\"NEW CONFIG\",this.state.config);\n});}},{key:\"getUIConfig\",value:function getUIConfig(key,val){var state=this.state;return state.config.ui[key];}},{key:\"setFilter\",value:function setFilter(field,criteria,type){if(field===undefined)return false;if(type===undefined)type=\"blacklist\";if(criteria===undefined)criteria=[];var filters=this.state.config.filters;var found=false;if(filters===undefined)filters=[];filters.forEach(function(filter,i){if(filter.field===field){found=true;filters[i]={field:field,criteria:criteria,type:type};}});if(found===false){filters.push({field:field,criteria:criteria,type:type});}var state=this.state;state.config.filters=filters;this.setState(state);}},{key:\"getFilter\",value:function getFilter(field){var filters=this.state.config.filters;for(var i in filters){if(filters[i].field===field)return filters[i];}return{field:field,criteria:[],type:\"whitelist\"};}},{key:\"deleteFilter\",value:function deleteFilter(field){var filters=this.state.config.filters;var newfilters=[];for(var i in filters){if(filters[i].field===field)continue;newfilters.push(filters[i]);}var state=this.state;state.config.filters=newfilters;this.setState(state);}},{key:\"getItemFromIndex\",value:function getItemFromIndex(id){try{if(typeof id===\"object\"){return id;}var index=this.state.masterData.idIndex[id];return index===undefined?null:this.state.masterData[index[0]][index[1]];}catch(e){if(this.log){console.log(\"[SEVERE] getting item from index by id \".concat(id,\" did not succeed \"),this.state.masterData,e);}}}},{key:\"loadConfigs\",value:function loadConfigs(configs){var state=this.state;state.config.filters=configs.config.filters;state.config.ui=configs.config.ui;state.state.ui.cookbook.isOpen=false;state.state.ui.infoBox.isOpen=false;state.state.ui.search.isOpen=false;this.setState(state);}},{key:\"onKeyDown\",value:function onKeyDown(keyEvent){if(keyEvent.metaKey)return null;if(keyEvent.ctrlKey)return null;if(keyEvent.code===\"Escape\")return null;if(keyEvent.code===\"Enter\")return AppController.onEnter(this);if(keyEvent.code===\"ArrowUp\")return AppController.onUp(this);if(keyEvent.code===\"ArrowDown\")return AppController.onDown(this);var searchState=this.getUIState(\"search\");if(/^[0-9A-z]$/.test(keyEvent.key)&&!searchState.isOpen){this.setUIState(\"search\",{isOpen:true,query:null,index:null});}}},{key:\"onDown\",value:function onDown(app){SearchControls.onMoveDown(app);}},{key:\"onUp\",value:function onUp(app){SearchControls.onMoveUp(app);}},{key:\"onEnter\",value:function onEnter(app){SearchControls.onSelect(app);}},{key:\"buildURL\",value:function buildURL(){}}]);return AppController;}();export{AppController as default};","map":{"version":3,"sources":["/Users/adam.tothfejel/Desktop/LabelBoxFolder/BirdHouse/src/controllers/AppController.js"],"names":["Utils","SearchControls","AppController","fetch","then","response","json","data","key","undefined","i","item","fields","id","idIndex","parseInt","setState","masterData","val","state","Array","isArray","scratch","push","dedupe","config","ui","field","criteria","type","filters","found","forEach","filter","newfilters","index","e","log","console","configs","cookbook","isOpen","infoBox","search","keyEvent","metaKey","ctrlKey","code","onEnter","onUp","onDown","searchState","getUIState","test","setUIState","query","app","onMoveDown","onMoveUp","onSelect"],"mappings":"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","sourcesContent":["\nimport Utils from './Utils';\nimport SearchControls from './SearchControls';\n\nexport default class AppController {\n\n\n    static loadMasterData() {\n        return fetch(\"./data/calls.json\")\n            .then(response => response.json())\n            .then(json => {\n                const data = {};\n                for (let key in json) {\n                    if (data[key] === undefined) {\n                        data[key] = [];\n                    }\n                    for (let i in json[key]) {\n                        const item = json[key][i];\n                        item.fields.id = item.id;\n                        data[key][i] = item.fields;\n                        if (!data.idIndex) {\n                            data.idIndex = {};\n                        }\n                        data.idIndex[item.id] = [key, parseInt(i)];\n                    }\n                }\n                //console.log(\"[LOG] data\", data);\n                this.setState({ masterData: data });\n                //this.setState({ masterData: data }, () => setTimeout(this.loadMasterData.bind(this), 60000))\n            });\n    }\n\n\n    static inputScratch(key, val) {\n        let state = this.state;\n        if (Array.isArray(state.scratch[key])) {\n            state.scratch[key].push(val);\n            state.scratch[key] = Utils.dedupe(state.scratch[key]);\n        }\n        else {\n            state.scratch[key] = val;\n        }\n        this.setState(state);\n    }\n\n    static setUIConfig(key, val) {\n        let state = this.state;\n        state.config.ui[key] = val;\n        this.setState(state, function () {\n             //console.log(\"NEW CONFIG\",this.state.config);\n        });\n    }\n\n    static getUIState(key, val) {\n        let state = this.state;\n        return state.state.ui[key];\n    }\n\n    static setUIState(key, val) {\n        let state = this.state;\n        state.state.ui[key] = val;\n        this.setState(state, function () {\n            // console.log(\"NEW CONFIG\",this.state.config);\n        });\n    }\n\n    static getUIConfig(key, val) {\n        let state = this.state;\n        return state.config.ui[key];\n    }\n\n    static setFilter(field, criteria, type) {\n\n\n        if (field === undefined) return false;\n        if (type === undefined) type = \"blacklist\";\n        if (criteria === undefined) criteria = [];\n\n        let filters = this.state.config.filters;\n        let found = false;\n        if (filters === undefined) filters = [];\n        filters.forEach((filter, i) => {\n            if (filter.field === field) {\n                found = true;\n                filters[i] = { field: field, criteria: criteria, type: type }\n            }\n        });\n        if (found === false) {\n            filters.push({ field: field, criteria: criteria, type: type });\n        }\n        let state = this.state;\n        state.config.filters = filters;\n        this.setState(state);\n    }\n\n    static getFilter(field) {\n        let filters = this.state.config.filters;\n        for (let i in filters) {\n            if (filters[i].field === field) return filters[i];\n        }\n        return { field: field, criteria: [], type: \"whitelist\" };\n    }\n    static deleteFilter(field) {\n        let filters = this.state.config.filters;\n        let newfilters = [];\n        for (let i in filters) {\n            if (filters[i].field === field) continue;\n            newfilters.push(filters[i]);\n        }\n        let state = this.state;\n        state.config.filters = newfilters;\n        this.setState(state);\n    }\n\n    static getItemFromIndex(id) {\n        try {\n            if (typeof id === \"object\") {\n                return id;\n            }\n            const index = this.state.masterData.idIndex[id];\n            return index === undefined ? null : this.state.masterData[index[0]][index[1]];\n        } catch (e) {\n            if (this.log) {\n                console.log(\n                    `[SEVERE] getting item from index by id ${id} did not succeed `,\n                    this.state.masterData,\n                    e\n                );\n            }\n        }\n    }\n\n    static loadConfigs(configs)\n    {\n        let state = this.state;\n        state.config.filters=configs.config.filters;\n        state.config.ui=configs.config.ui;\n        state.state.ui.cookbook.isOpen=false;\n        state.state.ui.infoBox.isOpen=false;\n        state.state.ui.search.isOpen=false;\n        this.setState(state);\n    }\n\n    static onKeyDown(keyEvent) {\n        \n        if(keyEvent.metaKey) return null;\n        if(keyEvent.ctrlKey ) return null;\n        if(keyEvent.code === \"Escape\") return null;\n        if(keyEvent.code === \"Enter\") return AppController.onEnter(this);\n        if(keyEvent.code === \"ArrowUp\") return AppController.onUp(this);\n        if(keyEvent.code === \"ArrowDown\") return AppController.onDown(this);\n\n        let searchState = this.getUIState(\"search\");\n        if (/^[0-9A-z]$/.test(keyEvent.key) && !searchState.isOpen) {\n\n            this.setUIState(\"search\", {\n                isOpen: true,\n                query: null,\n                index: null\n            })\n        }\n    }\n\n\n    static onDown(app) {\n        SearchControls.onMoveDown(app);\n    }\n        \n    static onUp(app) {\n\n        SearchControls.onMoveUp(app);\n    }\n        \n    static onEnter(app)\n    {\n        SearchControls.onSelect(app)\n    }\n\n\n    static buildURL()\n    {\n\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}