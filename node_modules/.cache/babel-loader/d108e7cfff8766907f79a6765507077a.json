{"ast":null,"code":"import _classCallCheck from\"/Users/adam.tothfejel/Desktop/LabelBoxFolder/BirdHouse/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import Query from\"../models/Query\";import Utils from\"./Utils\";import config from'../config.json';var SearchControls=function SearchControls(){_classCallCheck(this,SearchControls);};SearchControls.isOpen=function(app){var state=app.getUIState(\"search\");return state.isOpen;};SearchControls.isClosed=function(){this.setUIState(\"search\",{isOpen:false});};SearchControls.searchResults=function(app){var state=app.getUIState(\"search\");var query=state.query;if(Utils.isEmpty(query))return null;if(query.length<3)return 1;var results=this.loadAllItems(app);return SearchControls.filterResults(app,results,query);};SearchControls.loadAllItems=function(app){var elements=config.elements;var items=[];var _loop=function _loop(key){var query=new Query({app:app,query:key});var fieldkey=config.elements[key].field;if(config.elements[key].searchfield!==undefined)fieldkey=config.elements[key].searchfield;var segment=query.objects.map(function(item){return{\"value\":item.data.id,\"label\":item.data[fieldkey],type:key,badge:config.elements[key].label,color:config.elements[key].color};});items=items.concat(segment);};for(var key in elements){_loop(key);}return items;};SearchControls.filterResults=function(app,results,query){var filtered=[];var regex=new RegExp(query,'ig');for(var i in results){if(regex.test(results[i].label))filtered.push(results[i]);}// let search = app.getUIState(\"search\");\nreturn filtered;};SearchControls.selectSearchResult=function(selection){};SearchControls.onChange=function(event){this.setUIState(\"search\",{isOpen:true,query:event.target.value,index:0,count:0});};SearchControls.onMoveDown=function(app){var search=app.getUIState(\"search\");search.index++;if(search.index>search.count-1)search.index=0;app.setUIState(\"search\",search);};SearchControls.onMoveUp=function(app){var search=app.getUIState(\"search\");search.index--;if(search.index<0)search.index=0;app.setUIState(\"search\",search);};SearchControls.onSelect=function(app){var search=app.getUIState(\"search\");if(!search.isOpen)return false;var selection=SearchControls.searchResults(app)[search.index];var state=app.state;state.state.ui.search={isOpen:false,query:null,index:null,count:null};state.state.ui.infoBox={isOpen:true,type:selection.type,id:selection.value};app.setState(state);};export{SearchControls as default};","map":{"version":3,"sources":["/Users/adam.tothfejel/Desktop/LabelBoxFolder/BirdHouse/src/controllers/SearchControls.js"],"names":["Query","Utils","config","SearchControls","isOpen","app","state","getUIState","isClosed","setUIState","searchResults","query","isEmpty","length","results","loadAllItems","filterResults","elements","items","key","fieldkey","field","searchfield","undefined","segment","objects","map","item","data","id","type","badge","label","color","concat","filtered","regex","RegExp","i","test","push","selectSearchResult","selection","onChange","event","target","value","index","count","onMoveDown","search","onMoveUp","onSelect","ui","infoBox","setState"],"mappings":"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","sourcesContent":["import Query from \"../models/Query\";\nimport Utils from \"./Utils\";\nimport config from '../config.json';\nexport default class SearchControls {\n\n    static isOpen = function (app) {\n\n        let state = app.getUIState(\"search\");\n        return state.isOpen;\n    }\n\n    static isClosed = function () {\n\n        this.setUIState(\"search\", { isOpen: false })\n    }\n\n\n    static searchResults = function(app)\n    {\n        \n        let state = app.getUIState(\"search\");\n        let query = state.query;\n\n        if(Utils.isEmpty(query)) return null;\n        if(query.length<3) return 1;\n\n        let results = this.loadAllItems(app);\n        return SearchControls.filterResults(app,results,query);\n    }\n\n\n\n    static loadAllItems = function (app) {\n\n        let elements = config.elements;\n        let items = [];\n        for (let key in elements) {\n            let query = new Query({ app: app, query: key });\n            let fieldkey = config.elements[key].field;\n            if (config.elements[key].searchfield !== undefined) fieldkey = config.elements[key].searchfield;\n            let segment = query.objects.map(item => (\n                { \"value\": item.data.id, \"label\": item.data[fieldkey], type: key, badge: config.elements[key].label, color: config.elements[key].color }\n            ))\n            items = items.concat(segment);\n        }\n        return items;\n    }\n\n\n    static filterResults = function (app,results,query) {\n        let filtered = [];\n        let regex = new RegExp(query,'ig');\n        for(let i in results)\n        {\n            if (regex.test(results[i].label)) \n                filtered.push(results[i]);\n        }\n\n       // let search = app.getUIState(\"search\");\n        return filtered;\n    }\n\n    static selectSearchResult = function (selection) {\n\n\n    }\n\n    static onChange = function (event) {\n        this.setUIState(\"search\", { isOpen: true, query: event.target.value, index: 0, count: 0 });\n    }\n\n\n\n    static onMoveDown = function (app) {\n        let search = app.getUIState(\"search\");\n        search.index++;\n        if(search.index>(search.count-1)) search.index = 0;\n        app.setUIState(\"search\", search);\n    }\n\n\n    static onMoveUp = function (app) {\n        let search = app.getUIState(\"search\");\n        search.index--;\n        if(search.index<0) search.index = 0;\n        app.setUIState(\"search\", search);\n    }\n\n\n    static onSelect = function (app) {\n\n        let search = app.getUIState(\"search\");\n        if(!search.isOpen) return false;\n        let selection = SearchControls.searchResults(app)[search.index];\n\n        let state = app.state;\n\n        state.state.ui.search= {\n            isOpen: false,\n            query: null,\n            index: null,\n            count: null\n          };\n          state.state.ui.infoBox= {\n            isOpen: true,\n            type: selection.type,\n            id: selection.value\n          };\n\n          app.setState(state);\n\n    }\n\n\n\n}"]},"metadata":{},"sourceType":"module"}